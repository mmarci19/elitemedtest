

<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Bootstrap -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script> 
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Settings</title>
  <meta name="description" content="Core HTML Project">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- External CSS -->
  <link rel="stylesheet" href="vendor/bootstrap/bootstrap.min.css">
  <link rel="stylesheet" href="vendor/select2/select2.min.css">
  <link rel="stylesheet" href="vendor/owlcarousel/owl.carousel.min.css">
  <link rel="stylesheet" href="vendor/lightcase/lightcase.css">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Lato:300,400|Work+Sans:300,400,700" rel="stylesheet">

  <!-- CSS -->
  <link rel="stylesheet" href="https://cdn.linearicons.com/free/1.0.0/icon-font.min.css">
  <link href="https://file.myfontastic.com/7vRKgqrN3iFEnLHuqYhYuL/icons.css" rel="stylesheet">

  <!-- Modernizr JS for IE8 support of HTML5 elements and media queries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.js"></script>
  <!-- Bootstrap -->
  <script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>


    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Landing page template built with HTML and Bootstrap 4 for presenting training courses, classes, workshops and for convincing visitors to register using the form.">
    <meta name="author" content="Inovatik">

    <!-- OG Meta Tags to improve the way the post looks when you share the page on LinkedIn, Facebook, Google+ -->
	<meta property="og:site_name" content="" /> <!-- website name -->
	<meta property="og:site" content="" /> <!-- website link -->
	<meta property="og:title" content=""/> <!-- title shown in the actual shared post -->
	<meta property="og:description" content="" /> <!-- description shown in the actual shared post -->
	<meta property="og:image" content="" /> <!-- image link, make sure it's jpg -->
	<meta property="og:url" content="" /> <!-- where do you want your post to link to -->
	<meta property="og:type" content="article" />

    <!-- Website Title -->
    <title>ASAP</title>
    
    <!-- Styles -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,400i,600,700,700i&display=swap" rel="stylesheet">
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/fontawesome-all.css" rel="stylesheet">
    <link href="css/swiper.css" rel="stylesheet">
	<link href="css/magnific-popup.css" rel="stylesheet">
	<link href="css/styles.css" rel="stylesheet">
	
	<!-- Favicon  -->
    <link rel="icon" href="icon.png">
</head>

<style>
body{
  color: whitesmoke;
  background-color:rgb(41, 37, 37);
}

              

</style>
<body data-spy="scroll" data-target=".fixed-top">
    
    <!-- Preloader -->
	<div class="spinner-wrapper">
        <div class="spinner">
            <div class="bounce1"></div>
            <div class="bounce2"></div>
            <div class="bounce3"></div>
        </div>
    </div>
    <!-- end of preloader -->
    

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark navbar-custom fixed-top">

        <!-- Text Logo - Use this if you don't have a graphic logo -->
        <!-- <a class="navbar-brand logo-text page-scroll" href="index.html">Corso</a> -->


        <!-- Image Logo -->
        <a href="index.html"><img src="logo.png"width=6% height=6% ></a> 
        
        <!-- Mobile Menu Toggle Button -->
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-awesome fas fa-bars"></span>
            <span class="navbar-toggler-awesome fas fa-times"></span>
        </button>
        <!-- end of mobile menu toggle button -->

        <div class="collapse navbar-collapse" id="navbarsExampleDefault">
          <ul class="navbar-nav ml-auto">
              <li class="nav-item">
                  <a class="nav-link page-scroll" href="index.html">Main Menu <span class="sr-only">(current)</span></a>
              </li>
              <li class="nav-item">
                  <a class="nav-link page-scroll" href="settings.html">Settings</a>
              </li>

              <li class="nav-item">
                <a class="nav-link page-scroll" href="matches.html">Matches</a>
            </li>
            <li class="nav-item">
                <a class="nav-link page-scroll" href="recording.html">Recording</a>
            </li>

            <li class="nav-item">
                <a class="nav-link page-scroll" href="pitch-selector.html">Pitch Selector</a>
            </li>
          </ul>
         
      </div>
    </nav> <!-- end of navbar -->
    <!-- end of navigation -->


<!-- end of slider-1 -->
<!-- end of partners -->
    <!-- Header -->
    
      <div class="container" style="margin-top: 120px">
          <div class="row">
              <div class="col-lg-12">
                  <div class="text-container">
        
                      <h1 style="color: whitesmoke">Camera Settings</h1>
                      
                                     </div> <!-- end of text-container -->
              </div> <!-- end of col -->
          </div> <!-- end of row -->
      </div> <!-- end of container -->

    <div class="outer container" style="margin-top:20px">



      <div class="col-lg-4 form-group">
        <label for="setMatchID">Match ID</label>
        <input type="text" id = "setMatchID" class="form-control-input">
                  <button style="margin-top: 20px" id="btnCreate" type="button" onclick="createMatch()" class="btn btn-secondary" >Create Match</button>
      </div>

    <div id="mediaTypeSelector" name="mediaTypeSelector" style="display:none">
      
        <label for="inputS" style="margin-top: 20px; margin-right: 20px">Media Type</label>
    
        <div class="input-group mb-3" id="inputS">
      
          <div class="input-group-prepend">
    
    
              <div class="dropdown-list" id="dropdownlist-media">
      
                  <a class="btn" id="Camera" >Camera</a><br>
                  <a class="btn" id="File" >File</a><br>
                  <a class="btn" id="Something else">Something else</a><br>

                  <input id="mediaSelection" name="mediaSelection" value="" hidden><br>
    
              </div>
    
          </div>
        
        </div>
    </div>

    <div id="mediaSourceSelector" name="mediaSourceSelector" style="display:none">

    <div class="container" style="margin-top:20px">

      <label for="setCamera1" style="margin-top: 20px">Media Source</label>
      <input type="text" id = "setCamera1" class="form-control">
      <button id="ntbReg1"  style="margin-top: 20px" type="button" class="btn btn-warning" onclick="registerCamera()">Add Media Source </button>
      
    
    </div>
  </div>
    <div class="container" style="margin-top: 20px">


    </div>

  
    <div class="container" style="margin-top: 20px">
      <button id="sendForm"onclick="sendForm()"  class="btn btn-secondary" style="display:none">Next</button>
    </div>
    <div class="container" style="margin-top: 20px">

    </div>
    <!-- Partners -->

    <!-- Scripts -->
    <script src="js/jquery.min.js"></script> <!-- jQuery for Bootstrap's JavaScript plugins -->
    <script src="js/popper.min.js"></script> <!-- Popper tooltip library for Bootstrap -->
    <script src="js/bootstrap.min.js"></script> <!-- Bootstrap framework -->
    <script src="js/jquery.easing.min.js"></script> <!-- jQuery Easing for smooth scrolling between anchors -->
    <script src="js/jquery.countdown.min.js"></script> <!-- The Final Countdown plugin for jQuery -->
    <script src="js/swiper.min.js"></script> <!-- Swiper for image and text sliders -->
    <script src="js/jquery.magnific-popup.js"></script> <!-- Magnific Popup for lightboxes -->
    <script src="js/validator.min.js"></script> <!-- Validator.js - Bootstrap plugin that validates forms -->
    <script src="js/scripts.js"></script> <!-- Custom scripts -->
</body>
</html>

<script>

  var backupText = "";
  
  var cameras = 0;
  var users = 0;

  var camera1 = "";
  var camera2 = "";
  var camera3 = "";
  var camera4 = "";

  var selectedMedia= ""

  function cameraRegisterUI(){

  if(cameras >= 4)
  {
  FrontEndMessage("Camera limit reached! You cannot add more cameras.", "alert alert-warning");
  document.getElementById("ntbReg1").className = "btn-solid-lg";

  }
  else{
  FrontEndMessage("Success! Camera added.", "alert alert-success");
  
  if(cameras==0){
    document.getElementById("camera1text").textContent = (document.getElementById("setCamera1").value);
    camera1 = (document.getElementById("setCamera1").value);

  }
  if(cameras==1){
    document.getElementById("camera2text").textContent = (document.getElementById("setCamera1").value);
    camera2 = (document.getElementById("setCamera1").value);
  }
  if(cameras==2){
    document.getElementById("camera3text").textContent = (document.getElementById("setCamera1").value);
    camera3 = (document.getElementById("setCamera1").value);
  }
  if(cameras == 3){
    document.getElementById("camera4text").textContent = (document.getElementById("setCamera1").value);
    camera4 = (document.getElementById("setCamera1").value);
    FrontEndMessage("Camera limit reached! You cannot add more cameras.", "alert alert-warning");
  document.getElementById("ntbReg1").className = "btn-solid-lg";
  document.getElementById("setCamera1").value ="";
  }


  }
  cameras += 1;
  
  
  }
  
  
  
  //Testing (catfact.ninja/fact)
  function registerCamera() {

    if(document.getElementById("setCamera1").value === ""){
        FrontEndMessage("This field cannot be empty!", "alert alert-warning");
      }
      else{
      var xhr = new XMLHttpRequest();
      var url = "http://127.0.0.1:5000/register_camera"; 
      //var url = "https://catfact.ninja/fact"
      //var url = document.getElementById("setCamera").value
      xhr.open("POST", url, true);
      //xhr.open("POST",url,true);
      xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
      xhr.onreadystatechange = function () {
        if (xhr.readyState === 4 && xhr.status === 200) {
           //Responese handling
           var json = JSON.parse(xhr.responseText);
           //alert(json);
           //document.getElementById("logText").textContent = xhr.responseText;
           //document.getElementById("sampleText").textContent = json.fact;
  
          //Visual logic
          cameraRegisterUI();
          document.getElementById("sendForm").style="display:block"
        }
        else{
          FrontEndMessage("Cannot register camera. (Server error)", "alert alert-danger");
          document.getElementById("setCamera1").value="";
        }
    }
  
    //sample data
    //var data = JSON.stringify({"match_id":"123", "camera_url":"rtsp://wowzaec2demo.streamlock.net/vod/mp4:BigBuckBunny_115k.mov"});
    cameraURL = document.getElementById("setCamera1").value;
    //document.getElementById("camerasrctext").textContent.concat(cameraURL);
    
    var data = `{"match_id":${matchID}, "media_type":"${selectedMedia.toLowerCase()}", "media_url":"${cameraURL}"}`;
    
    if(matchID===undefined){
      FrontEndMessage("Set the match ID!", "alert alert-warning");
    }
    else{
      //xhr.send();
    }
    //alert(data);
    xhr.send(data);
  
    }
    //TEST FUNCTION, UNCOMMENT IF NO BACKEND
    //document.getElementById("sendForm").style="display:block"

  }
  $(document).ready(function () {

  $('#dropdownlist-media a').on('click', function () {
  selectedMedia = ($(this).text());
  document.getElementById("Camera").classList="btn"
  document.getElementById("File").classList="btn"
  document.getElementById("Something else").classList="btn"
  document.getElementById(selectedMedia).classList="btn btn-solid-lg"
  document.getElementById("mediaSourceSelector").style="display:block"

  });
  });
  </script>







</div>

<div class="container col-lg-4">
  <div id="generalErrorMsg" class="alert alert-danger col-lg-4" style="display: none;">
    <strong id="ErrorMsg">Lorem</strong> Ipsum
  </div>

</div>


<script>
  var cameraURL = "";


function FrontEndMessage(text,type){
  document.getElementById("generalErrorMsg").textContent=text;
  document.getElementById("generalErrorMsg").className=type;
  document.getElementById("generalErrorMsg").style="display:block";
}


function FrontEndMessageDisappear(){
  document.getElementById("generalErrorMsg").style="display:none";

}


  function refreshMatchID(){
 
      if(document.getElementById("setMatchID").value === ""){
        FrontEndMessage("This field cannot be empty!", "alert alert-warning");
      }
      else{
        matchID = document.getElementById("setMatchID").value; 
        document.getElementById("matchIDtext").textContent = matchID;
        FrontEndMessage("Match ID set.", "alert alert-info");

      }
      document.getElementById("setMatchID").value = "";

  }

</script>

<form id="startRecordingNoSelectorForm" action="recording.html" style="margin-top: 50px;" method="GET">
  <input type="hidden" value="" name="id" id="startRecordingNoSelectorFormInput" />
</form>

<form id="startRecordingForm" action="pitch-selector.html" style="margin-top: 50px;" method="GET">
  <input type="hidden" value="" name="id" id="startRecordingFormInput" />
  <input type="hidden" value="" name="cameraCount" id="cameraCount" />
  <input type="hidden" value="" name="camera1" id="camera1" />
  <input type="hidden" value="" name="camera2" id="camera2" />
  <input type="hidden" value="" name="camera3" id="camera3" />
  <input type="hidden" value="" name="camera4" id="camera4" />
</form>





<p style="display: none" id="camerasrctextbackup"></p>

<div class=container id="matchCreateTable">
  
  <table class="table table-borderless" id="tableMatch" >
    <thead>
      <tr>
        <th>Match ID</th>
        <th>Camera URL</th>
        
      </tr>
    </thead>
    <tbody>
      <tr class="success">
        <td id="matchIDtext"></td>
          

        </td>
          <td id="camera1text" >

           

 
          
          </td>
            <td id="ownertext" >
             


             
            
            
            </td>
        <td id="user1text">

            
        </td>
      </tr>
      <tr>
        <td></td>
        <td id="camera2text"></td>
        <td></td>
        <td id="user2text"></td>
      </tr>
      <tr>
        <td></td>
        <td id="camera3text"></td>
        <td></td>
        <td id="user3text"></td>
      </tr>
      <tr>
        <td></td>
        <td id="camera4text"></td>
        <td></td>
        <td id="user4text"></td>
      </tr>
    </tbody>
    </table>



</div>



<script>



function sendForm(){

  if(matchID===undefined){
    FrontEndMessage("Set the match ID!", "alert alert-warning");
  }
  else{
    //alert("Server side check to see if match exists!");
    //document.getElementById("startRecordingFormInput").value = matchID;
    document.getElementById("startRecordingFormInput").value = matchID; 
    
    document.getElementById("cameraCount").value = cameras;
    document.getElementById("camera1").value = camera1;
    document.getElementById("camera2").value = camera2;
    document.getElementById("camera3").value = camera3;
    document.getElementById("camera4").value = camera4;
    if(cameras == 0){
      FrontEndMessage("No cameras set. Provide at least one camera source for the pitch selector.", "alert alert-danger");
    }
    else{
      document.getElementById("startRecordingForm").submit();
    }

  }
 
}



var matchID;

var owner = "";
var user1 = "";
var user2 = "";
var user3 = "";
var user4 = "";


function setOwner(){
   owner = document.getElementById("setOwner").value;
   if(document.getElementById("setOwner").value === ""){
    FrontEndMessage("This field cannot be empty!", "alert alert-warning");
   }
   else
   {
    FrontEndMessage("Owner added! You can add only one owner.", "alert alert-info");
    document.getElementById("ownertext").textContent = owner;
    document.getElementById("btnOwner").className = "btn-solig-lg";
    
   }
   document.getElementById("setOwner").value="";
  }

function setUser(){


   if(document.getElementById("setUser1").value === ""){
    FrontEndMessage("This field cannot be empty!", "alert alert-warning");
   }
   else
   {
   if(users >= 4){
    FrontEndMessage("User limit reached! You cannot add more users.", "alert alert-warning");
    document.getElementById("ntbuserReg1").className = "btn btn-outline-secondary"

   }
   else{
    FrontEndMessageDisappear();
    FrontEndMessage("User added! Add a new user!", "alert alert-info");
     if( users == 0 ){
      user1 = document.getElementById("setUser1").value;
      document.getElementById("user1text").textContent = user1;
    }
    if( users == 1){
      user2 = document.getElementById("setUser1").value;
      document.getElementById("user2text").textContent = user2;
    }
    if( users == 2){
      user3 = document.getElementById("setUser1").value;
      document.getElementById("user3text").textContent = user3;
    }
    if( users == 3){
      user4 = document.getElementById("setUser1").value;
      document.getElementById("user4text").textContent = user4;
      FrontEndMessage("User limit reached! You cannot add more users.", "alert alert-warning");
    document.getElementById("ntbuserReg1").className = "btn btn-outline-secondary"
    

    }
    users += 1;

   }
  }
  document.getElementById("setUser1").value = "";
}







  function startRecording(){

    var xhr = new XMLHttpRequest();
    var url = " http://127.0.0.1:5000/start_recording"; 
    //var url = document.getElementById("setCamera").value
    xhr.open("POST", url, true);
    xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
    xhr.onreadystatechange = function () {
      if (xhr.readyState === 4 && xhr.status === 200) {
         //Responese handling
         //var json = JSON.parse(xhr.responseText);
         document.getElementById("logText").textContent = xhr.responseText;
         //alert(json.responseText);
      }
      else{
        FrontEndMessage("Cannot start recording. (Server error)", "alert alert-danger");
      }
  };
  //sample data
  var data = `${matchID}`;

  if(matchID===undefined){
    FrontEndMessage("Set the match ID!", "alert alert-warning");
  }
  else{
    xhr.send(data);
  }


  let k = document.getElementById("startRecordingForm");
  k.submit();


  }


  function createMatch(){
    refreshMatchID()
    //TEST , UNCOMMENT IF NO BACKEND IS PRESENT
    ///document.getElementById("mediaTypeSelector").style="display:block"

    if(matchID===undefined){
      FrontEndMessage("Set the match ID!", "alert alert-warning");
  }
  else{
  
  
    var xhr = new XMLHttpRequest();
    var url = " http://127.0.0.1:5000/create_match"; 
    
    xhr.open("POST", url, true);
    xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");

    xhr.onreadystatechange = function () {
      if (xhr.readyState === 4 && xhr.status === 200) {
         //Responese handling
         var json = JSON.parse(xhr.responseText);
         document.getElementById("mediaTypeSelector").style="display:block"

         FrontEndMessage("Success! Match created with match ID: " + matchID, "alert alert-success");
      }
      else{
        FrontEndMessage("Cannot create match. (Server error).", "alert alert-danger");
      }
  };

  //sample data
  //FYI: az alabbi kikommentezett nem jo, mert user2-tol felfele minden üres és érvénytelen json-t kapunk
  //var data = `{"id":${matchID},"owner":"${owner}","user":[${user1}, ${user2}, ${user3}, ${user4}]}`;
  //var data = `{"id":${matchID},"owner":"${owner}","user":[${user1}]}`;
  
  var data = `{"id":${matchID},"owner":"pista","users":["edzo","tanacsado"]}`;

  //alert(data);
  
  xhr.send(data);
  }

}
  function watch_recording(){
 
    if(matchID===undefined){
      FrontEndMessage("Set the match ID!", "alert alert-warning");
  }
  else{
    alert("Server side check to see if match exists!");
  document.getElementById("startRecordingNoSelectorFormInput").value = matchID;
  document.getElementById("startRecordingNoSelectorForm").submit();
  
  }
}


</script>
<!-- Scripts -->
<script src="js/jquery.min.js"></script> <!-- jQuery for Bootstrap's JavaScript plugins -->
<script src="js/popper.min.js"></script> <!-- Popper tooltip library for Bootstrap -->
<script src="js/bootstrap.min.js"></script> <!-- Bootstrap framework -->
<script src="js/jquery.easing.min.js"></script> <!-- jQuery Easing for smooth scrolling between anchors -->
<script src="js/jquery.countdown.min.js"></script> <!-- The Final Countdown plugin for jQuery -->
<script src="js/swiper.min.js"></script> <!-- Swiper for image and text sliders -->
<script src="js/jquery.magnific-popup.js"></script> <!-- Magnific Popup for lightboxes -->
<script src="js/validator.min.js"></script> <!-- Validator.js - Bootstrap plugin that validates forms -->
<script src="js/scripts.js"></script> <!-- Custom scripts -->
